import{aC as K,aH as Te,b as be,f as ee,v as ke,P as de,aX as xe,aY as Oe,k as Ce,u as Ee,aZ as Ve,E as R,ao as Re,aj as $e,q as Ae,a_ as Pe,aq as Me,a$ as Fe,b0 as Be,_ as Ie,g as q,a6 as De,w as ze,b1 as Ye,b2 as Xe,aD as je,b3 as He,M as Ue,b4 as Ke,d as qe,c as We}from"./el-button-BPh_G9Ns.js";import{v as Ze}from"./el-loading-BBAA0u1d.js";import{E as Ge}from"./el-dialog-DeciRpM7.js";import"./el-overlay-zVvDA8t1.js";import{a as Qe,E as Je}from"./el-form-item-Dvi8za3X.js";import{E as ea}from"./el-card-WJRpVXyY.js";import{E as aa}from"./el-pagination-CYgLDAKk.js";import"./el-scrollbar-ViEF51Jw.js";import{d as ta}from"./el-select-D-jhMQjF.js";import{E as na}from"./el-empty-CTH9Xt6a.js";/* empty css                 */import{d as ie,aa as _e,g as p,ak as la,a0 as oa,c as E,E as fe,I as Se,A as pe,o as y,b as re,w as i,j as l,T as sa,i as d,n as C,u as a,x as ye,L as ra,e as V,a as I,F as ae,r as ia,k as Le,O as Ne,P as ua,f as se,a5 as ca,q as he,Q as da,t as me,_ as fa,Z as ma,l as we}from"./index-DoZiZmvY.js";import{g as pa}from"./plant-rIoRMkY5.js";import{E as va}from"./index-DA3cOSt1.js";import{a as ga,g as _a}from"./index-CBLBCCTW.js";import{E as U}from"./index-C6vTP1ry.js";import"./index-Jp57_oih.js";import"./_initCloneObject-DTD4hlhT.js";import"./isEqual-CGCEJ5oO.js";const ya=(m,g)=>{if(!K||!m||!g)return!1;const s=m.getBoundingClientRect();let _;return g instanceof Element?_=g.getBoundingClientRect():_={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<_.bottom&&s.bottom>_.top&&s.right>_.left&&s.left<_.right};var ha="Expected a function";function ce(m,g,s){var _=!0,n=!0;if(typeof m!="function")throw new TypeError(ha);return Te(s)&&(_="leading"in s?!!s.leading:_,n="trailing"in s?!!s.trailing:n),ta(m,g,{leading:_,maxWait:g,trailing:n})}const wa=be({urlList:{type:ee(Array),default:()=>ke([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:ee(String)}}),ba={close:()=>!0,switch:m=>de(m),rotate:m=>de(m)},ka=ie({name:"ElImageViewer"}),Ca=ie({...ka,props:wa,emits:ba,setup(m,{expose:g,emit:s}){var _;const n=m,v={CONTAIN:{name:"contain",icon:_e(xe)},ORIGINAL:{name:"original",icon:_e(Oe)}},{t:W}=Ce(),c=Ee("image-viewer"),{nextZIndex:Y}=Ve(),N=p(),z=p([]),S=la(),L=p(!0),b=p(n.initialIndex),k=oa(v.CONTAIN),o=p({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),r=p((_=n.zIndex)!=null?_:Y()),$=E(()=>{const{urlList:t}=n;return t.length<=1}),A=E(()=>b.value===0),P=E(()=>b.value===n.urlList.length-1),B=E(()=>n.urlList[b.value]),Z=E(()=>[c.e("btn"),c.e("prev"),c.is("disabled",!n.infinite&&A.value)]),X=E(()=>[c.e("btn"),c.e("next"),c.is("disabled",!n.infinite&&P.value)]),D=E(()=>{const{scale:t,deg:w,offsetX:f,offsetY:T,enableTransition:x}=o.value;let O=f/t,F=T/t;const J=w*Math.PI/180,ve=Math.cos(J),ge=Math.sin(J);O=O*ve+F*ge,F=F*ve-f/t*ge;const ue={transform:`scale(${t}) rotate(${w}deg) translate(${O}px, ${F}px)`,transition:x?"transform .3s":""};return k.value.name===v.CONTAIN.name&&(ue.maxWidth=ue.maxHeight="100%"),ue});function M(){j(),s("close")}function G(){const t=ce(f=>{switch(f.code){case U.esc:n.closeOnPressEscape&&M();break;case U.space:le();break;case U.left:oe();break;case U.up:h("zoomIn");break;case U.right:e();break;case U.down:h("zoomOut");break}}),w=ce(f=>{const T=f.deltaY||f.deltaX;h(T<0?"zoomIn":"zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});S.run(()=>{q(document,"keydown",t),q(document,"wheel",w)})}function j(){S.stop()}function H(){L.value=!1}function u(t){L.value=!1,t.target.alt=W("el.image.error")}function te(t){if(L.value||t.button!==0||!N.value)return;o.value.enableTransition=!1;const{offsetX:w,offsetY:f}=o.value,T=t.pageX,x=t.pageY,O=ce(J=>{o.value={...o.value,offsetX:w+J.pageX-T,offsetY:f+J.pageY-x}}),F=q(document,"mousemove",O);q(document,"mouseup",()=>{F()}),t.preventDefault()}function ne(){o.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function le(){if(L.value)return;const t=De(v),w=Object.values(v),f=k.value.name,x=(w.findIndex(O=>O.name===f)+1)%t.length;k.value=v[t[x]],ne()}function Q(t){const w=n.urlList.length;b.value=(t+w)%w}function oe(){A.value&&!n.infinite||Q(b.value-1)}function e(){P.value&&!n.infinite||Q(b.value+1)}function h(t,w={}){if(L.value)return;const{minScale:f,maxScale:T}=n,{zoomRate:x,rotateDeg:O,enableTransition:F}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...w};switch(t){case"zoomOut":o.value.scale>f&&(o.value.scale=Number.parseFloat((o.value.scale/x).toFixed(3)));break;case"zoomIn":o.value.scale<T&&(o.value.scale=Number.parseFloat((o.value.scale*x).toFixed(3)));break;case"clockwise":o.value.deg+=O,s("rotate",o.value.deg);break;case"anticlockwise":o.value.deg-=O,s("rotate",o.value.deg);break}o.value.enableTransition=F}return fe(B,()=>{Se(()=>{const t=z.value[0];t!=null&&t.complete||(L.value=!0)})}),fe(b,t=>{ne(),s("switch",t)}),pe(()=>{var t,w;G(),(w=(t=N.value)==null?void 0:t.focus)==null||w.call(t)}),g({setActiveItem:Q}),(t,w)=>(y(),re(a(ga),{to:"body",disabled:!t.teleported},{default:i(()=>[l(sa,{name:"viewer-fade",appear:""},{default:i(()=>[d("div",{ref_key:"wrapper",ref:N,tabindex:-1,class:C(a(c).e("wrapper")),style:ye({zIndex:r.value})},[d("div",{class:C(a(c).e("mask")),onClick:ra(f=>t.hideOnClickModal&&M(),["self"])},null,10,["onClick"]),V(" CLOSE "),d("span",{class:C([a(c).e("btn"),a(c).e("close")]),onClick:M},[l(a(R),null,{default:i(()=>[l(a(Re))]),_:1})],2),V(" ARROW "),a($)?V("v-if",!0):(y(),I(ae,{key:0},[d("span",{class:C(a(Z)),onClick:oe},[l(a(R),null,{default:i(()=>[l(a($e))]),_:1})],2),d("span",{class:C(a(X)),onClick:e},[l(a(R),null,{default:i(()=>[l(a(Ae))]),_:1})],2)],64)),V(" ACTIONS "),d("div",{class:C([a(c).e("btn"),a(c).e("actions")])},[d("div",{class:C(a(c).e("actions__inner"))},[l(a(R),{onClick:f=>h("zoomOut")},{default:i(()=>[l(a(Pe))]),_:1},8,["onClick"]),l(a(R),{onClick:f=>h("zoomIn")},{default:i(()=>[l(a(Me))]),_:1},8,["onClick"]),d("i",{class:C(a(c).e("actions__divider"))},null,2),l(a(R),{onClick:le},{default:i(()=>[(y(),re(ia(a(k).icon)))]),_:1}),d("i",{class:C(a(c).e("actions__divider"))},null,2),l(a(R),{onClick:f=>h("anticlockwise")},{default:i(()=>[l(a(Fe))]),_:1},8,["onClick"]),l(a(R),{onClick:f=>h("clockwise")},{default:i(()=>[l(a(Be))]),_:1},8,["onClick"])],2)],2),V(" CANVAS "),d("div",{class:C(a(c).e("canvas"))},[(y(!0),I(ae,null,Le(t.urlList,(f,T)=>Ne((y(),I("img",{ref_for:!0,ref:x=>z.value[T]=x,key:f,src:f,style:ye(a(D)),class:C(a(c).e("img")),crossorigin:t.crossorigin,onLoad:H,onError:u,onMousedown:te},null,46,["src","crossorigin"])),[[ua,T===b.value]])),128))],2),se(t.$slots,"default")],6)]),_:3})]),_:3},8,["disabled"]))}});var Ea=Ie(Ca,[["__file","image-viewer.vue"]]);const Ia=ze(Ea),za=be({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:ee([String,Object])},previewSrcList:{type:ee(Array),default:()=>ke([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:ee(String)}}),Sa={load:m=>m instanceof Event,error:m=>m instanceof Event,switch:m=>de(m),close:()=>!0,show:()=>!0},La=ie({name:"ElImage",inheritAttrs:!1}),Na=ie({...La,props:za,emits:Sa,setup(m,{emit:g}){const s=m;let _="";const{t:n}=Ce(),v=Ee("image"),W=ca(),c=E(()=>Ye(Object.entries(W).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),Y=Xe({excludeListeners:!0,excludeKeys:E(()=>Object.keys(c.value))}),N=p(),z=p(!1),S=p(!0),L=p(!1),b=p(),k=p(),o=K&&"loading"in HTMLImageElement.prototype;let r,$;const A=E(()=>[v.e("inner"),B.value&&v.e("preview"),S.value&&v.is("loading")]),P=E(()=>{const{fit:e}=s;return K&&e?{objectFit:e}:{}}),B=E(()=>{const{previewSrcList:e}=s;return Array.isArray(e)&&e.length>0}),Z=E(()=>{const{previewSrcList:e,initialIndex:h}=s;let t=h;return h>e.length-1&&(t=0),t}),X=E(()=>s.loading==="eager"?!1:!o&&s.loading==="lazy"||s.lazy),D=()=>{K&&(S.value=!0,z.value=!1,N.value=s.src)};function M(e){S.value=!1,z.value=!1,g("load",e)}function G(e){S.value=!1,z.value=!0,g("error",e)}function j(){ya(b.value,k.value)&&(D(),te())}const H=He(j,200,!0);async function u(){var e;if(!K)return;await Se();const{scrollContainer:h}=s;je(h)?k.value=h:da(h)&&h!==""?k.value=(e=document.querySelector(h))!=null?e:void 0:b.value&&(k.value=_a(b.value)),k.value&&(r=q(k,"scroll",H),setTimeout(()=>j(),100))}function te(){!K||!k.value||!H||(r==null||r(),k.value=void 0)}function ne(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function le(){B.value&&($=q("wheel",ne,{passive:!1}),_=document.body.style.overflow,document.body.style.overflow="hidden",L.value=!0,g("show"))}function Q(){$==null||$(),document.body.style.overflow=_,L.value=!1,g("close")}function oe(e){g("switch",e)}return fe(()=>s.src,()=>{X.value?(S.value=!0,z.value=!1,te(),u()):D()}),pe(()=>{X.value?u():D()}),(e,h)=>(y(),I("div",he({ref_key:"container",ref:b},a(c),{class:[a(v).b(),e.$attrs.class]}),[z.value?se(e.$slots,"error",{key:0},()=>[d("div",{class:C(a(v).e("error"))},me(a(n)("el.image.error")),3)]):(y(),I(ae,{key:1},[N.value!==void 0?(y(),I("img",he({key:0},a(Y),{src:N.value,loading:e.loading,style:a(P),class:a(A),crossorigin:e.crossorigin,onClick:le,onLoad:M,onError:G}),null,16,["src","loading","crossorigin"])):V("v-if",!0),S.value?(y(),I("div",{key:1,class:C(a(v).e("wrapper"))},[se(e.$slots,"placeholder",{},()=>[d("div",{class:C(a(v).e("placeholder"))},null,2)])],2)):V("v-if",!0)],64)),a(B)?(y(),I(ae,{key:2},[L.value?(y(),re(a(Ia),{key:0,"z-index":e.zIndex,"initial-index":a(Z),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:Q,onSwitch:oe},{default:i(()=>[e.$slots.viewer?(y(),I("div",{key:0},[se(e.$slots,"viewer")])):V("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):V("v-if",!0)],64)):V("v-if",!0)],16))}});var Ta=Ie(Na,[["__file","image.vue"]]);const xa=ze(Ta),Oa={class:"plant-manage"},Va={class:"card-header"},Ra={class:"header-right"},$a={class:"plant-grid"},Aa={key:1,class:"plant-list"},Pa={class:"plant-image"},Ma={class:"image-placeholder"},Fa={class:"plant-content"},Ba={class:"plant-name"},Da={class:"plant-description"},Ya={class:"pagination-container"},Xa={class:"dialog-footer"},ja={__name:"PlantCategories",setup(m){const g=p([]),s=p(!1),_=p("新增植物种类"),n=p({pageNum:1,pageSize:5,search:""}),v=p({name:"",imgUrl:"null",careInstructions:"",id:""}),W={name:[{required:!0,message:"请输入植物名称",trigger:"blur"}],careInstructions:[{required:!0,message:"请输入养护说明",trigger:"blur"}]},c=p(null),Y=p(0),N=p(!1),z=async()=>{try{N.value=!0;const o=await pa(n.value);o.data.code==="1"&&(g.value=o.data.data.records,Y.value=o.data.data.total)}catch{va.error("获取植物种类列表失败")}finally{N.value=!1}},S=()=>{n.value.pageNum=1,z()},L=()=>{n.value.search="",S()},b=o=>{n.value.pageNum=o,z()},k=o=>{n.value.pageSize=o,n.value.pageNum=1,z()};return pe(()=>{z()}),(o,r)=>{const $=R,A=qe,P=We,B=na,Z=xa,X=aa,D=ea,M=Qe,G=Je,j=Ge,H=Ze;return y(),I("div",Oa,[l(D,{class:"plant-card mt-4"},{header:i(()=>[d("div",Va,[r[7]||(r[7]=d("span",{class:"title"},"植物百科",-1)),d("div",Ra,[l(P,{modelValue:n.value.search,"onUpdate:modelValue":r[0]||(r[0]=u=>n.value.search=u),placeholder:"搜索植物名称",class:"search-input",clearable:"",onKeyup:ma(S,["enter"]),onClear:L},{append:i(()=>[l(A,{onClick:S},{default:i(()=>[l($,null,{default:i(()=>[l(a(Ue))]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),default:i(()=>[Ne((y(),I("div",$a,[g.value.length?(y(),I("div",Aa,[(y(!0),I(ae,null,Le(g.value,u=>(y(),I("div",{key:u.id,class:"plant-item"},[d("div",Pa,[l(Z,{src:u.imgUrl==="null"?"/default-plant.jpg":u.imgUrl,fit:"cover",alt:u.name},{error:i(()=>[d("div",Ma,[l($,null,{default:i(()=>[l(a(Ke))]),_:1})])]),_:2},1032,["src","alt"])]),d("div",Fa,[d("h3",Ba,me(u.name),1),d("p",Da,me(u.careInstructions),1)])]))),128))])):(y(),re(B,{key:0,description:"暂无植物种类"}))])),[[H,N.value]]),d("div",Ya,[l(X,{"current-page":n.value.pageNum,"onUpdate:currentPage":r[1]||(r[1]=u=>n.value.pageNum=u),"page-size":n.value.pageSize,"onUpdate:pageSize":r[2]||(r[2]=u=>n.value.pageSize=u),"page-sizes":[5,10,20,50],total:Y.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:k,onCurrentChange:b},null,8,["current-page","page-size","total"])])]),_:1}),l(j,{modelValue:s.value,"onUpdate:modelValue":r[6]||(r[6]=u=>s.value=u),title:_.value,width:"500px","destroy-on-close":"","close-on-click-modal":!1,class:"plant-dialog"},{footer:i(()=>[d("div",Xa,[l(A,{onClick:r[5]||(r[5]=u=>s.value=!1)},{default:i(()=>r[8]||(r[8]=[we("取消")])),_:1}),l(A,{type:"primary",onClick:o.submitTypeForm},{default:i(()=>r[9]||(r[9]=[we("确定")])),_:1},8,["onClick"])])]),default:i(()=>[l(G,{ref_key:"plantTypeFormRef",ref:c,model:v.value,rules:W,"label-width":"100px"},{default:i(()=>[l(M,{label:"植物名称",prop:"name"},{default:i(()=>[l(P,{modelValue:v.value.name,"onUpdate:modelValue":r[3]||(r[3]=u=>v.value.name=u),placeholder:"请输入植物名称"},null,8,["modelValue"])]),_:1}),l(M,{label:"养护说明",prop:"careInstructions"},{default:i(()=>[l(P,{modelValue:v.value.careInstructions,"onUpdate:modelValue":r[4]||(r[4]=u=>v.value.careInstructions=u),type:"textarea",rows:4,placeholder:"请输入养护说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ct=fa(ja,[["__scopeId","data-v-e7258f90"]]);export{ct as default};
