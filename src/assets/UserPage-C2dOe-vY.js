import{b as G,f as $,u as H,a3 as De,am as _e,aa as Ne,an as Q,ao as ie,E as q,_ as J,w as Pe,t as ue,y as Ee,v as oe,k as Oe,X as Y,ap as Ve,aq as Ae,ar as Ie,as as je,at as qe,$ as Me,d as ze,au as Ke,l as de,av as te,a as He,aw as We,ax as Xe,ay as ce,c as Ge}from"./el-button-BPh_G9Ns.js";import{E as Je}from"./el-dialog-DeciRpM7.js";import"./el-overlay-zVvDA8t1.js";import{b as Qe,E as Ye,a as Ze}from"./el-form-item-Dvi8za3X.js";/* empty css                 */import{E as xe}from"./el-avatar-BX8gO55S.js";import{d as I,c as B,a6 as Ue,Q as pe,o as w,a as S,n as b,u as a,i as k,x as M,f as O,t as X,e as U,b as A,w as v,r as ea,$ as Ce,a7 as D,g as j,F as aa,k as ta,Z as Se,L as W,j as f,a8 as sa,z as oa,a0 as re,a9 as fe,E as le,B as ra,y as la,D as na,J as ve,q as me,_ as ia,h as ua,l as K}from"./index-DoZiZmvY.js";import{b as ye,c as se,d as da}from"./user-D_00CXbF.js";import{a as ca}from"./默认头像-DeX7ZciU.js";/* empty css                 *//* empty css                   */import{E as P}from"./index-DA3cOSt1.js";import{i as pa}from"./isEqual-CGCEJ5oO.js";import"./index-Jp57_oih.js";import"./index-CBLBCCTW.js";import"./index-C6vTP1ry.js";import"./_initCloneObject-DTD4hlhT.js";var fa=1,va=4;function ge(n){return Qe(n,fa|va)}const ma=G({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:n=>n>=0&&n<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:$(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:$([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:$(Function),default:n=>`${n}%`}}),ya=I({name:"ElProgress"}),ga=I({...ya,props:ma,setup(n){const s=n,t={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},i=H("progress"),c=B(()=>{const l={width:`${s.percentage}%`,animationDuration:`${s.duration}s`},g=E(s.percentage);return g.includes("gradient")?l.background=g:l.backgroundColor=g,l}),p=B(()=>(s.strokeWidth/s.width*100).toFixed(1)),m=B(()=>["circle","dashboard"].includes(s.type)?Number.parseInt(`${50-Number.parseFloat(p.value)/2}`,10):0),C=B(()=>{const l=m.value,g=s.type==="dashboard";return`
          M 50 50
          m 0 ${g?"":"-"}${l}
          a ${l} ${l} 0 1 1 0 ${g?"-":""}${l*2}
          a ${l} ${l} 0 1 1 0 ${g?"":"-"}${l*2}
          `}),h=B(()=>2*Math.PI*m.value),F=B(()=>s.type==="dashboard"?.75:1),T=B(()=>`${-1*h.value*(1-F.value)/2}px`),y=B(()=>({strokeDasharray:`${h.value*F.value}px, ${h.value}px`,strokeDashoffset:T.value})),V=B(()=>({strokeDasharray:`${h.value*F.value*(s.percentage/100)}px, ${h.value}px`,strokeDashoffset:T.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),r=B(()=>{let l;return s.color?l=E(s.percentage):l=t[s.status]||t.default,l}),d=B(()=>s.status==="warning"?De:s.type==="line"?s.status==="success"?_e:Ne:s.status==="success"?Q:ie),e=B(()=>s.type==="line"?12+s.strokeWidth*.4:s.width*.111111+2),o=B(()=>s.format(s.percentage));function u(l){const g=100/l.length;return l.map((_,N)=>pe(_)?{color:_,percentage:(N+1)*g}:_).sort((_,N)=>_.percentage-N.percentage)}const E=l=>{var g;const{color:R}=s;if(Ue(R))return R(l);if(pe(R))return R;{const _=u(R);for(const N of _)if(N.percentage>l)return N.color;return(g=_[_.length-1])==null?void 0:g.color}};return(l,g)=>(w(),S("div",{class:b([a(i).b(),a(i).m(l.type),a(i).is(l.status),{[a(i).m("without-text")]:!l.showText,[a(i).m("text-inside")]:l.textInside}]),role:"progressbar","aria-valuenow":l.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[l.type==="line"?(w(),S("div",{key:0,class:b(a(i).b("bar"))},[k("div",{class:b(a(i).be("bar","outer")),style:M({height:`${l.strokeWidth}px`})},[k("div",{class:b([a(i).be("bar","inner"),{[a(i).bem("bar","inner","indeterminate")]:l.indeterminate},{[a(i).bem("bar","inner","striped")]:l.striped},{[a(i).bem("bar","inner","striped-flow")]:l.stripedFlow}]),style:M(a(c))},[(l.showText||l.$slots.default)&&l.textInside?(w(),S("div",{key:0,class:b(a(i).be("bar","innerText"))},[O(l.$slots,"default",{percentage:l.percentage},()=>[k("span",null,X(a(o)),1)])],2)):U("v-if",!0)],6)],6)],2)):(w(),S("div",{key:1,class:b(a(i).b("circle")),style:M({height:`${l.width}px`,width:`${l.width}px`})},[(w(),S("svg",{viewBox:"0 0 100 100"},[k("path",{class:b(a(i).be("circle","track")),d:a(C),stroke:`var(${a(i).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":l.strokeLinecap,"stroke-width":a(p),fill:"none",style:M(a(y))},null,14,["d","stroke","stroke-linecap","stroke-width"]),k("path",{class:b(a(i).be("circle","path")),d:a(C),stroke:a(r),fill:"none",opacity:l.percentage?1:0,"stroke-linecap":l.strokeLinecap,"stroke-width":a(p),style:M(a(V))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(l.showText||l.$slots.default)&&!l.textInside?(w(),S("div",{key:2,class:b(a(i).e("text")),style:M({fontSize:`${a(e)}px`})},[O(l.$slots,"default",{percentage:l.percentage},()=>[l.status?(w(),A(a(q),{key:1},{default:v(()=>[(w(),A(ea(a(d))))]),_:1})):(w(),S("span",{key:0},X(a(o)),1))])],6)):U("v-if",!0)],10,["aria-valuenow"]))}});var ha=J(ga,[["__file","progress.vue"]]);const ba=Pe(ha),Fe=Symbol("uploadContextKey"),wa="ElUpload";class ka extends Error{constructor(s,t,i,c){super(s),this.name="UploadAjaxError",this.status=t,this.method=i,this.url=c}}function he(n,s,t){let i;return t.response?i=`${t.response.error||t.response}`:t.responseText?i=`${t.responseText}`:i=`fail to ${s.method} ${n} ${t.status}`,new ka(i,t.status,s.method,n)}function $a(n){const s=n.responseText||n.response;if(!s)return s;try{return JSON.parse(s)}catch{return s}}const _a=n=>{typeof XMLHttpRequest>"u"&&ue(wa,"XMLHttpRequest is undefined");const s=new XMLHttpRequest,t=n.action;s.upload&&s.upload.addEventListener("progress",p=>{const m=p;m.percent=p.total>0?p.loaded/p.total*100:0,n.onProgress(m)});const i=new FormData;if(n.data)for(const[p,m]of Object.entries(n.data))Ce(m)&&m.length?i.append(p,...m):i.append(p,m);i.append(n.filename,n.file,n.file.name),s.addEventListener("error",()=>{n.onError(he(t,n,s))}),s.addEventListener("load",()=>{if(s.status<200||s.status>=300)return n.onError(he(t,n,s));n.onSuccess($a(s))}),s.open(n.method,t,!0),n.withCredentials&&"withCredentials"in s&&(s.withCredentials=!0);const c=n.headers||{};if(c instanceof Headers)c.forEach((p,m)=>s.setRequestHeader(m,p));else for(const[p,m]of Object.entries(c))Ee(m)||s.setRequestHeader(p,String(m));return s.send(i),s},Re=["text","picture","picture-card"];let Pa=1;const ne=()=>Date.now()+Pa++,Le=G({action:{type:String,default:"#"},headers:{type:$(Object)},method:{type:String,default:"post"},data:{type:$([Object,Function,Promise]),default:()=>oe({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:$(Array),default:()=>oe([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:Re,default:"text"},httpRequest:{type:$(Function),default:_a},disabled:Boolean,limit:Number}),Ea=G({...Le,beforeUpload:{type:$(Function),default:D},beforeRemove:{type:$(Function)},onRemove:{type:$(Function),default:D},onChange:{type:$(Function),default:D},onPreview:{type:$(Function),default:D},onSuccess:{type:$(Function),default:D},onProgress:{type:$(Function),default:D},onError:{type:$(Function),default:D},onExceed:{type:$(Function),default:D},crossorigin:{type:$(String)}}),Ua=G({files:{type:$(Array),default:()=>oe([])},disabled:{type:Boolean,default:!1},handlePreview:{type:$(Function),default:D},listType:{type:String,values:Re,default:"text"},crossorigin:{type:$(String)}}),Ca={remove:n=>!!n},Sa=I({name:"ElUploadList"}),Fa=I({...Sa,props:Ua,emits:Ca,setup(n,{emit:s}){const t=n,{t:i}=Oe(),c=H("upload"),p=H("icon"),m=H("list"),C=Y(),h=j(!1),F=B(()=>[c.b("list"),c.bm("list",t.listType),c.is("disabled",t.disabled)]),T=y=>{s("remove",y)};return(y,V)=>(w(),A(sa,{tag:"ul",class:b(a(F)),name:a(m).b()},{default:v(()=>[(w(!0),S(aa,null,ta(y.files,(r,d)=>(w(),S("li",{key:r.uid||r.name,class:b([a(c).be("list","item"),a(c).is(r.status),{focusing:h.value}]),tabindex:"0",onKeydown:Se(e=>!a(C)&&T(r),["delete"]),onFocus:e=>h.value=!0,onBlur:e=>h.value=!1,onClick:e=>h.value=!1},[O(y.$slots,"default",{file:r,index:d},()=>[y.listType==="picture"||r.status!=="uploading"&&y.listType==="picture-card"?(w(),S("img",{key:0,class:b(a(c).be("list","item-thumbnail")),src:r.url,crossorigin:y.crossorigin,alt:""},null,10,["src","crossorigin"])):U("v-if",!0),r.status==="uploading"||y.listType!=="picture-card"?(w(),S("div",{key:1,class:b(a(c).be("list","item-info"))},[k("a",{class:b(a(c).be("list","item-name")),onClick:W(e=>y.handlePreview(r),["prevent"])},[f(a(q),{class:b(a(p).m("document"))},{default:v(()=>[f(a(Ve))]),_:1},8,["class"]),k("span",{class:b(a(c).be("list","item-file-name")),title:r.name},X(r.name),11,["title"])],10,["onClick"]),r.status==="uploading"?(w(),A(a(ba),{key:0,type:y.listType==="picture-card"?"circle":"line","stroke-width":y.listType==="picture-card"?6:2,percentage:Number(r.percentage),style:M(y.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):U("v-if",!0)],2)):U("v-if",!0),k("label",{class:b(a(c).be("list","item-status-label"))},[y.listType==="text"?(w(),A(a(q),{key:0,class:b([a(p).m("upload-success"),a(p).m("circle-check")])},{default:v(()=>[f(a(_e))]),_:1},8,["class"])):["picture-card","picture"].includes(y.listType)?(w(),A(a(q),{key:1,class:b([a(p).m("upload-success"),a(p).m("check")])},{default:v(()=>[f(a(Q))]),_:1},8,["class"])):U("v-if",!0)],2),a(C)?U("v-if",!0):(w(),A(a(q),{key:2,class:b(a(p).m("close")),onClick:e=>T(r)},{default:v(()=>[f(a(ie))]),_:2},1032,["class","onClick"])),U(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),U(" This is a bug which needs to be fixed "),U(" TODO: Fix the incorrect navigation interaction "),a(C)?U("v-if",!0):(w(),S("i",{key:3,class:b(a(p).m("close-tip"))},X(a(i)("el.upload.deleteTip")),3)),y.listType==="picture-card"?(w(),S("span",{key:4,class:b(a(c).be("list","item-actions"))},[k("span",{class:b(a(c).be("list","item-preview")),onClick:e=>y.handlePreview(r)},[f(a(q),{class:b(a(p).m("zoom-in"))},{default:v(()=>[f(a(Ae))]),_:1},8,["class"])],10,["onClick"]),a(C)?U("v-if",!0):(w(),S("span",{key:0,class:b(a(c).be("list","item-delete")),onClick:e=>T(r)},[f(a(q),{class:b(a(p).m("delete"))},{default:v(()=>[f(a(Ie))]),_:1},8,["class"])],10,["onClick"]))],2)):U("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),O(y.$slots,"append")]),_:3},8,["class","name"]))}});var be=J(Fa,[["__file","upload-list.vue"]]);const Ra=G({disabled:{type:Boolean,default:!1}}),La={file:n=>Ce(n)},Te="ElUploadDrag",Ta=I({name:Te}),Ba=I({...Ta,props:Ra,emits:La,setup(n,{emit:s}){oa(Fe)||ue(Te,"usage: <el-upload><el-upload-dragger /></el-upload>");const i=H("upload"),c=j(!1),p=Y(),m=h=>{if(p.value)return;c.value=!1,h.stopPropagation();const F=Array.from(h.dataTransfer.files);s("file",F)},C=()=>{p.value||(c.value=!0)};return(h,F)=>(w(),S("div",{class:b([a(i).b("dragger"),a(i).is("dragover",c.value)]),onDrop:W(m,["prevent"]),onDragover:W(C,["prevent"]),onDragleave:W(T=>c.value=!1,["prevent"])},[O(h.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var Da=J(Ba,[["__file","upload-dragger.vue"]]);const Na=G({...Le,beforeUpload:{type:$(Function),default:D},onRemove:{type:$(Function),default:D},onStart:{type:$(Function),default:D},onSuccess:{type:$(Function),default:D},onProgress:{type:$(Function),default:D},onError:{type:$(Function),default:D},onExceed:{type:$(Function),default:D}}),Oa=I({name:"ElUploadContent",inheritAttrs:!1}),Va=I({...Oa,props:Na,setup(n,{expose:s}){const t=n,i=H("upload"),c=Y(),p=re({}),m=re(),C=e=>{if(e.length===0)return;const{autoUpload:o,limit:u,fileList:E,multiple:l,onStart:g,onExceed:R}=t;if(u&&E.length+e.length>u){R(e,E);return}l||(e=e.slice(0,1));for(const _ of e){const N=_;N.uid=ne(),g(N),o&&h(N)}},h=async e=>{if(m.value.value="",!t.beforeUpload)return T(e);let o,u={};try{const l=t.data,g=t.beforeUpload(e);u=fe(t.data)?ge(t.data):t.data,o=await g,fe(t.data)&&pa(l,u)&&(u=ge(t.data))}catch{o=!1}if(o===!1){t.onRemove(e);return}let E=e;o instanceof Blob&&(o instanceof File?E=o:E=new File([o],e.name,{type:e.type})),T(Object.assign(E,{uid:e.uid}),u)},F=async(e,o)=>Ue(e)?e(o):e,T=async(e,o)=>{const{headers:u,data:E,method:l,withCredentials:g,name:R,action:_,onProgress:N,onSuccess:Z,onError:L,httpRequest:Be}=t;try{o=await F(o??E,e)}catch{t.onRemove(e);return}const{uid:x}=e,ee={headers:u||{},withCredentials:g,file:e,data:o,method:l,filename:R,action:_,onProgress:z=>{N(z,e)},onSuccess:z=>{Z(z,e),delete p.value[x]},onError:z=>{L(z,e),delete p.value[x]}},ae=Be(ee);p.value[x]=ae,ae instanceof Promise&&ae.then(ee.onSuccess,ee.onError)},y=e=>{const o=e.target.files;o&&C(Array.from(o))},V=()=>{c.value||(m.value.value="",m.value.click())},r=()=>{V()};return s({abort:e=>{je(p.value).filter(e?([u])=>String(e.uid)===u:()=>!0).forEach(([u,E])=>{E instanceof XMLHttpRequest&&E.abort(),delete p.value[u]})},upload:h}),(e,o)=>(w(),S("div",{class:b([a(i).b(),a(i).m(e.listType),a(i).is("drag",e.drag),a(i).is("disabled",a(c))]),tabindex:a(c)?"-1":"0",onClick:V,onKeydown:Se(W(r,["self"]),["enter","space"])},[e.drag?(w(),A(Da,{key:0,disabled:a(c),onFile:C},{default:v(()=>[O(e.$slots,"default")]),_:3},8,["disabled"])):O(e.$slots,"default",{key:1}),k("input",{ref_key:"inputRef",ref:m,class:b(a(i).e("input")),name:e.name,disabled:a(c),multiple:e.multiple,accept:e.accept,type:"file",onChange:y,onClick:W(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var we=J(Va,[["__file","upload-content.vue"]]);const ke="ElUpload",$e=n=>{var s;(s=n.url)!=null&&s.startsWith("blob:")&&URL.revokeObjectURL(n.url)},Aa=(n,s)=>{const t=qe(n,"fileList",void 0,{passive:!0}),i=r=>t.value.find(d=>d.uid===r.uid);function c(r){var d;(d=s.value)==null||d.abort(r)}function p(r=["ready","uploading","success","fail"]){t.value=t.value.filter(d=>!r.includes(d.status))}function m(r){t.value=t.value.filter(d=>d!==r)}const C=(r,d)=>{const e=i(d);e&&(console.error(r),e.status="fail",m(e),n.onError(r,e,t.value),n.onChange(e,t.value))},h=(r,d)=>{const e=i(d);e&&(n.onProgress(r,e,t.value),e.status="uploading",e.percentage=Math.round(r.percent))},F=(r,d)=>{const e=i(d);e&&(e.status="success",e.response=r,n.onSuccess(r,e,t.value),n.onChange(e,t.value))},T=r=>{Ee(r.uid)&&(r.uid=ne());const d={name:r.name,percentage:0,status:"ready",size:r.size,raw:r,uid:r.uid};if(n.listType==="picture-card"||n.listType==="picture")try{d.url=URL.createObjectURL(r)}catch(e){Me(ke,e.message),n.onError(e,d,t.value)}t.value=[...t.value,d],n.onChange(d,t.value)},y=async r=>{const d=r instanceof File?i(r):r;d||ue(ke,"file to be removed not found");const e=o=>{c(o),m(o),n.onRemove(o,t.value),$e(o)};n.beforeRemove?await n.beforeRemove(d,t.value)!==!1&&e(d):e(d)};function V(){t.value.filter(({status:r})=>r==="ready").forEach(({raw:r})=>{var d;return r&&((d=s.value)==null?void 0:d.upload(r))})}return le(()=>n.listType,r=>{r!=="picture-card"&&r!=="picture"||(t.value=t.value.map(d=>{const{raw:e,url:o}=d;if(!o&&e)try{d.url=URL.createObjectURL(e)}catch(u){n.onError(u,d,t.value)}return d}))}),le(t,r=>{for(const d of r)d.uid||(d.uid=ne()),d.status||(d.status="success")},{immediate:!0,deep:!0}),{uploadFiles:t,abort:c,clearFiles:p,handleError:C,handleProgress:h,handleStart:T,handleSuccess:F,handleRemove:y,submit:V,revokeFileObjectURL:$e}},Ia=I({name:"ElUpload"}),ja=I({...Ia,props:Ea,setup(n,{expose:s}){const t=n,i=Y(),c=re(),{abort:p,submit:m,clearFiles:C,uploadFiles:h,handleStart:F,handleError:T,handleRemove:y,handleSuccess:V,handleProgress:r,revokeFileObjectURL:d}=Aa(t,c),e=B(()=>t.listType==="picture-card"),o=B(()=>({...t,fileList:h.value,onStart:F,onProgress:r,onSuccess:V,onError:T,onRemove:y}));return ra(()=>{h.value.forEach(d)}),la(Fe,{accept:na(t,"accept")}),s({abort:p,submit:m,clearFiles:C,handleStart:F,handleRemove:y}),(u,E)=>(w(),S("div",null,[a(e)&&u.showFileList?(w(),A(be,{key:0,disabled:a(i),"list-type":u.listType,files:a(h),crossorigin:u.crossorigin,"handle-preview":u.onPreview,onRemove:a(y)},ve({append:v(()=>[f(we,me({ref_key:"uploadRef",ref:c},a(o)),{default:v(()=>[u.$slots.trigger?O(u.$slots,"trigger",{key:0}):U("v-if",!0),!u.$slots.trigger&&u.$slots.default?O(u.$slots,"default",{key:1}):U("v-if",!0)]),_:3},16)]),_:2},[u.$slots.file?{name:"default",fn:v(({file:l,index:g})=>[O(u.$slots,"file",{file:l,index:g})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):U("v-if",!0),!a(e)||a(e)&&!u.showFileList?(w(),A(we,me({key:1,ref_key:"uploadRef",ref:c},a(o)),{default:v(()=>[u.$slots.trigger?O(u.$slots,"trigger",{key:0}):U("v-if",!0),!u.$slots.trigger&&u.$slots.default?O(u.$slots,"default",{key:1}):U("v-if",!0)]),_:3},16)):U("v-if",!0),u.$slots.trigger?O(u.$slots,"default",{key:2}):U("v-if",!0),O(u.$slots,"tip"),!a(e)&&u.showFileList?(w(),A(be,{key:3,disabled:a(i),"list-type":u.listType,files:a(h),crossorigin:u.crossorigin,"handle-preview":u.onPreview,onRemove:a(y)},ve({_:2},[u.$slots.file?{name:"default",fn:v(({file:l,index:g})=>[O(u.$slots,"file",{file:l,index:g})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):U("v-if",!0)]))}});var qa=J(ja,[["__file","upload.vue"]]);const Ma=Pe(qa),za={class:"user-page"},Ka={class:"profile-header"},Ha={class:"user-header-info"},Wa={class:"avatar-wrapper"},Xa={class:"avatar-upload-icon"},Ga={class:"user-name"},Ja={class:"user-title"},Qa={class:"profile-content"},Ya={class:"profile-card"},Za={class:"quick-actions"},xa={class:"info-section"},et={class:"bg-upload-wrapper"},at={class:"upload-area"},tt={class:"dialog-footer"},st={__name:"UserPage",setup(n){const s=ua(),t=j({id:s.user.id,nickName:s.user.nickName,password:s.user.password,email:s.user.email,phone:s.user.phone,avatar:s.user.avatar,username:s.user.username,diyBk:s.user.diyBk}),i=j({oldPassword:"",newPassword:"",confirmPassword:""}),c=j(!1),p=j(""),m=j(null),C=j(""),h=j(null),F=e=>{p.value=URL.createObjectURL(e.raw),m.value=e.raw},T=e=>{C.value=URL.createObjectURL(e.raw),h.value=e.raw},y=async()=>{try{(await se({id:t.value.id,nickName:t.value.nickName,avatar:t.value.avatar,email:t.value.email,phone:t.value.phone})).data.code==="1"?(s.setUser({...s.user,...t.value}),P.success("保存成功")):P.error("保存失败")}catch(e){console.error("保存用户信息失败:",e),P.error("保存失败")}},V=async()=>{if(i.value.newPassword!==i.value.confirmPassword){P.error("新密码与确认密码不一致");return}if(i.value.oldPassword!==s.user.password){P.error("旧密码输入错误");return}try{(await da({id:t.value.id,password:i.value.newPassword})).data.code==="1"?(s.setUser({...s.user,password:i.value.newPassword}),i.value={oldPassword:"",newPassword:"",confirmPassword:""},c.value=!1,P.success("密码修改成功")):P.error("密码修改失败")}catch(e){console.error("修改密码失败:",e),P.error("修改密码失败")}},r=async()=>{if(!m.value)return P.error("请选择头像");try{new FormData().append("file",m.value);const o=await ye(m.value);if(o.data.code==="1"){const u=o.data.data,E=await se({id:t.value.id,nickName:t.value.nickName,avatar:u,email:t.value.email,phone:t.value.phone,diyBk:t.value.diyBk});E.data.code==="1"?(s.setUser({...s.user,avatar:u}),t.value.avatar=u,P.success("头像更新成功")):P.error(E.data.msg||"头像更新失败")}else P.error(o.data.msg||"头像上传失败")}catch(e){console.error("上传头像失败:",e),e.response?P.error(`上传失败: ${e.response.data.msg||"服务器错误"}`):e.request?P.error("网络错误，请检查网络连接"):P.error("上传失败，请稍后重试")}},d=async()=>{if(!h.value)return P.error("请选择背景图");try{const e=await ye(h.value);if(e.data.code==="1"){const o=e.data.data,u=await se({id:t.value.id,nickName:t.value.nickName,avatar:t.value.avatar,email:t.value.email,phone:t.value.phone,diyBk:o});u.data.code==="1"?(s.setUser({...s.user,diyBk:o}),t.value.diyBk=o,P.success("背景图更新成功")):P.error(u.data.msg||"背景图更新失败")}else P.error(e.data.msg||"背景图上传失败")}catch(e){console.error("上传背景图失败:",e),e.response?P.error(`上传失败: ${e.response.data.msg||"服务器错误"}`):e.request?P.error("网络错误，请检查网络连接"):P.error("上传失败，请稍后重试")}};return le(()=>s.user,e=>{t.value={...e}},{deep:!0}),(e,o)=>{const u=xe,E=q,l=Ma,g=ze,R=Ge,_=Ze,N=Ye,Z=Je;return w(),S("div",za,[k("div",Ka,[o[9]||(o[9]=k("div",{class:"header-overlay"},null,-1)),k("div",Ha,[k("div",Wa,[f(u,{size:130,src:p.value||t.value.avatar||a(ca),class:"profile-avatar"},null,8,["src"]),k("div",Xa,[f(l,{class:"avatar-uploader",accept:"image/*","show-file-list":!1,"auto-upload":!1,onChange:F},{default:v(()=>[f(E,null,{default:v(()=>[f(a(Ke))]),_:1})]),_:1})])]),k("h1",Ga,X(a(s).user.nickName),1),k("p",Ja,X(a(s).user.username||"未设置昵称"),1)])]),k("div",Qa,[k("div",Ya,[k("div",Za,[f(g,{type:"primary",icon:a(de),round:"",onClick:o[0]||(o[0]=L=>c.value=!0)},{default:v(()=>o[10]||(o[10]=[K(" 修改密码 ")])),_:1},8,["icon"]),f(g,{type:"success",icon:a(te),round:"",disabled:!p.value,onClick:r},{default:v(()=>o[11]||(o[11]=[K(" 更新头像 ")])),_:1},8,["icon","disabled"])]),k("div",xa,[o[15]||(o[15]=k("h3",{class:"section-title"},"个人信息",-1)),f(N,{model:t.value,"label-width":"80px",class:"info-form"},{default:v(()=>[f(_,{label:"昵称"},{default:v(()=>[f(R,{modelValue:t.value.nickName,"onUpdate:modelValue":o[1]||(o[1]=L=>t.value.nickName=L),placeholder:"设置昵称","prefix-icon":a(He)},null,8,["modelValue","prefix-icon"])]),_:1}),f(_,{label:"邮箱"},{default:v(()=>[f(R,{modelValue:t.value.email,"onUpdate:modelValue":o[2]||(o[2]=L=>t.value.email=L),placeholder:"设置邮箱","prefix-icon":a(We)},null,8,["modelValue","prefix-icon"])]),_:1}),f(_,{label:"手机号"},{default:v(()=>[f(R,{modelValue:t.value.phone,"onUpdate:modelValue":o[3]||(o[3]=L=>t.value.phone=L),placeholder:"设置手机号","prefix-icon":a(Xe)},null,8,["modelValue","prefix-icon"])]),_:1}),f(_,{label:"背景图"},{default:v(()=>[k("div",et,[k("div",{class:"bg-preview",style:M({backgroundImage:`url(${C.value||t.value.diyBk})`})},[f(l,{class:"bg-uploader",accept:"image/*","show-file-list":!1,"auto-upload":!1,onChange:T},{default:v(()=>[k("div",at,[f(E,null,{default:v(()=>[f(a(te))]),_:1}),o[12]||(o[12]=k("span",null,"点击更换背景图",-1))])]),_:1})],4),f(g,{type:"primary",icon:a(te),disabled:!C.value,onClick:d,class:"upload-btn"},{default:v(()=>o[13]||(o[13]=[K(" 更新背景图 ")])),_:1},8,["icon","disabled"])])]),_:1}),f(_,null,{default:v(()=>[f(g,{type:"primary",icon:a(Q),onClick:y},{default:v(()=>o[14]||(o[14]=[K(" 保存修改 ")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])])])]),f(Z,{modelValue:c.value,"onUpdate:modelValue":o[8]||(o[8]=L=>c.value=L),title:"修改密码",width:"400px",center:"","destroy-on-close":""},{footer:v(()=>[k("span",tt,[f(g,{icon:a(ie),onClick:o[7]||(o[7]=L=>c.value=!1)},{default:v(()=>o[16]||(o[16]=[K("取消")])),_:1},8,["icon"]),f(g,{type:"primary",icon:a(Q),onClick:V},{default:v(()=>o[17]||(o[17]=[K("确认")])),_:1},8,["icon"])])]),default:v(()=>[f(N,{model:i.value,"label-width":"100px"},{default:v(()=>[f(_,{label:"旧密码"},{default:v(()=>[f(R,{modelValue:i.value.oldPassword,"onUpdate:modelValue":o[4]||(o[4]=L=>i.value.oldPassword=L),type:"password","show-password":"","prefix-icon":a(de)},null,8,["modelValue","prefix-icon"])]),_:1}),f(_,{label:"新密码"},{default:v(()=>[f(R,{modelValue:i.value.newPassword,"onUpdate:modelValue":o[5]||(o[5]=L=>i.value.newPassword=L),type:"password","show-password":"","prefix-icon":a(ce)},null,8,["modelValue","prefix-icon"])]),_:1}),f(_,{label:"确认密码"},{default:v(()=>[f(R,{modelValue:i.value.confirmPassword,"onUpdate:modelValue":o[6]||(o[6]=L=>i.value.confirmPassword=L),type:"password","show-password":"","prefix-icon":a(ce)},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},kt=ia(st,[["__scopeId","data-v-22ea1d7f"]]);export{kt as default};
