import{W as t,X as u,g as n}from"./index-DoZiZmvY.js";const d=()=>t.get("/messages"),g=()=>t.get("/messages/unreadNum"),i=s=>t.put(`/messages/${s}/read`),y=u("message",()=>{const s=n([]),a=n(0);return{messages:s,unreadCount:a,fetchMessages:async()=>{try{const e=await d();e.data.code==="1"&&(s.value=e.data.data)}catch(e){console.error("获取消息列表失败:",e)}},fetchUnreadCount:async()=>{try{const e=await g();e.data.code==="1"&&(a.value=e.data.data)}catch(e){console.error("获取未读消息数量失败:",e)}},markAsRead:async e=>{try{if((await i(e)).data.code==="1"){const o=s.value.find(c=>c.id===e);o&&(o.isRead=!0),a.value=Math.max(0,a.value-1)}}catch(r){console.error("标记消息已读失败:",r)}},$reset:()=>{s.value=[],a.value=0}}},{persist:!0});export{y as u};
